description: BackstageSpec defines the desired state of Backstage
properties:
  application:
    description: Configuration for Backstage. Optional.
    properties:
      appConfig:
        description: |-
          References to existing app-configs ConfigMap objects, that will be mounted as files in the specified mount path.
          Each element can be a reference to any ConfigMap or Secret,
          and will be mounted inside the main application container under a specified mount directory.
          Additionally, each file will be passed as a `--config /mount/path/to/configmap/key` to the
          main container args in the order of the entries defined in the AppConfigs list.
          But bear in mind that for a single ConfigMap element containing several filenames,
          the order in which those files will be appended to the main container args cannot be guaranteed.
          So if you want to pass multiple app-config files, it is recommended to pass one ConfigMap per app-config file.
        properties:
          configMaps:
            description: |-
              List of ConfigMaps storing the app-config files. Will be mounted as files under the MountPath specified.
              For each item in this array, if a key is not specified, it means that all keys in the ConfigMap will be mounted as files.
              Otherwise, only the specified key will be mounted as a file.
              Bear in mind not to put sensitive data in those ConfigMaps. Instead, your app-config content can reference
              environment variables (which you can set with the ExtraEnvs field) and/or include extra files (see the ExtraFiles field).
              More details on https://backstage.io/docs/conf/writing/.
            items:
              properties:
                key:
                  description: Key in the object
                  type: string
                mountPath:
                  description: Path to mount the Object. If not specified default-path/Name will be used
                  type: string
                name:
                  description: |-
                    Name of the object
                    Supported ConfigMaps and Secrets
                  type: string
              required:
                - name
              type: object
            type: array
          mountPath:
            default: /opt/app-root/src
            description: Mount path for all app-config files listed in the ConfigMapRefs field
            type: string
        type: object
      dynamicPluginsConfigMapName:
        description: |-
          Reference to an existing ConfigMap for Dynamic Plugins.
          A new one will be generated with the default config if not set.
          The ConfigMap object must have an existing key named: 'dynamic-plugins.yaml'.
        type: string
      extraEnvs:
        description: Extra environment variables
        properties:
          configMaps:
            description: |-
              List of references to ConfigMaps objects to inject as additional environment variables.
              For each item in this array, if a key is not specified, it means that all keys in the ConfigMap will be injected as additional environment variables.
              Otherwise, only the specified key will be injected as an additional environment variable.
            items:
              properties:
                key:
                  description: Key in the object
                  type: string
                name:
                  description: |-
                    Name of the object
                    We support only ConfigMaps and Secrets.
                  type: string
              required:
                - name
              type: object
            type: array
          envs:
            description: List of name and value pairs to add as environment variables.
            items:
              properties:
                name:
                  description: Name of the environment variable
                  type: string
                value:
                  description: Value of the environment variable
                  type: string
              required:
                - name
                - value
              type: object
            type: array
          secrets:
            description: |-
              List of references to Secrets objects to inject as additional environment variables.
              For each item in this array, if a key is not specified, it means that all keys in the Secret will be injected as additional environment variables.
              Otherwise, only the specified key will be injected as environment variable.
            items:
              properties:
                key:
                  description: Key in the object
                  type: string
                name:
                  description: |-
                    Name of the object
                    We support only ConfigMaps and Secrets.
                  type: string
              required:
                - name
              type: object
            type: array
        type: object
      extraFiles:
        description: |-
          References to existing Config objects to use as extra config files.
          They will be mounted as files in the specified mount path.
          Each element can be a reference to any ConfigMap or Secret.
        properties:
          configMaps:
            description: |-
              List of references to ConfigMaps objects mounted as extra files under the MountPath specified.
              For each item in this array, if a key is not specified, it means that all keys in the ConfigMap will be mounted as files.
              Otherwise, only the specified key will be mounted as a file.
            items:
              properties:
                key:
                  description: Key in the object
                  type: string
                mountPath:
                  description: Path to mount the Object. If not specified default-path/Name will be used
                  type: string
                name:
                  description: |-
                    Name of the object
                    Supported ConfigMaps and Secrets
                  type: string
              required:
                - name
              type: object
            type: array
          mountPath:
            default: /opt/app-root/src
            description: Mount path for all extra configuration files listed in the Items field
            type: string
          pvcs:
            description: |-
              List of references to Persistent Volume Claim objects mounted as extra files
              For each item in this array, a key must be specified that will be mounted as a file.
            items:
              properties:
                mountPath:
                  description: Path to mount PVC. If not specified default-path/Name will be used
                  type: string
                name:
                  description: Name of the object
                  type: string
              required:
                - name
              type: object
            type: array
          secrets:
            description: |-
              List of references to Secrets objects mounted as extra files under the MountPath specified.
              For each item in this array, a key must be specified that will be mounted as a file.
            items:
              properties:
                key:
                  description: Key in the object
                  type: string
                mountPath:
                  description: Path to mount the Object. If not specified default-path/Name will be used
                  type: string
                name:
                  description: |-
                    Name of the object
                    Supported ConfigMaps and Secrets
                  type: string
              required:
                - name
              type: object
            type: array
        type: object
      image:
        description: |-
          Custom image to use in all containers (including Init Containers).
          It is your responsibility to make sure the image is from trusted sources and has been validated for security compliance
        type: string
      imagePullSecrets:
        description: Image Pull Secrets to use in all containers (including Init Containers)
        items:
          type: string
        type: array
      replicas:
        default: 1
        description: |-
          Number of desired replicas to set in the Backstage Deployment.
          Defaults to 1.
        format: int32
        type: integer
      route:
        description: Route configuration. Used for OpenShift only.
        properties:
          enabled:
            default: true
            description: Control the creation of a Route on OpenShift.
            type: boolean
          host:
            description: |-
              Host is an alias/DNS that points to the service. Optional.
              Ignored if Enabled is false.
              If not specified a route name will typically be automatically
              chosen.  Must follow DNS952 subdomain conventions.
            maxLength: 253
            pattern: ^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$
            type: string
          subdomain:
            description: |-
              Subdomain is a DNS subdomain that is requested within the ingress controller's
              domain (as a subdomain).
              Ignored if Enabled is false.
              Example: subdomain `frontend` automatically receives the router subdomain
              `apps.mycluster.com` to have a full hostname `frontend.apps.mycluster.com`.
            maxLength: 253
            pattern: ^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$
            type: string
          tls:
            description: |-
              The tls field provides the ability to configure certificates for the route.
              Ignored if Enabled is false.
            properties:
              caCertificate:
                description: caCertificate provides the cert authority certificate contents
                type: string
              certificate:
                description: |-
                  certificate provides certificate contents. This should be a single serving certificate, not a certificate
                  chain. Do not include a CA certificate.
                type: string
              externalCertificateSecretName:
                description: |-
                  ExternalCertificateSecretName provides certificate contents as a secret reference.
                  This should be a single serving certificate, not a certificate
                  chain. Do not include a CA certificate. The secret referenced should
                  be present in the same namespace as that of the Route.
                  Forbidden when `certificate` is set.
                  Note that securing Routes with external certificates in TLS secrets is a Technology Preview feature in OpenShift,
                  and requires enabling the `RouteExternalCertificate` OpenShift Feature Gate and might not be functionally complete.
                type: string
              key:
                description: key provides key file contents
                type: string
            type: object
        type: object
    type: object
  database:
    description: Configuration for database access. Optional.
    properties:
      authSecretName:
        description: |-
          Name of the secret for database authentication. Optional.
          For a local database deployment (EnableLocalDb=true), a secret will be auto generated if it does not exist.
          The secret shall include information used for the database access.
          An example for PostgreSQL DB access:
          "POSTGRES_PASSWORD": "rl4s3Fh4ng3M4"
          "POSTGRES_PORT": "5432"
          "POSTGRES_USER": "postgres"
          "POSTGRESQL_ADMIN_PASSWORD": "rl4s3Fh4ng3M4"
          "POSTGRES_HOST": "backstage-psql-bs1"  # For local database, set to "backstage-psql-<CR name>".
        type: string
      enableLocalDb:
        default: true
        description: Control the creation of a local PostgreSQL DB. Set to false if using for example an external Database for Backstage.
        type: boolean
    type: object
  deployment:
    description: |-
      Valid fragment of Deployment to be merged with default/raw configuration.
      Set the Deployment's metadata and|or spec fields you want to override or add.
      Optional.
    properties:
      patch:
        description: |-
          Valid fragment of Deployment to be merged with default/raw configuration.
          Set the Deployment's metadata and|or spec fields you want to override or add.
          Optional.
        x-kubernetes-preserve-unknown-fields: true
    type: object
  rawRuntimeConfig:
    description: Raw Runtime RuntimeObjects configuration. For Advanced scenarios.
    properties:
      backstageConfig:
        description: Name of ConfigMap containing Backstage runtime objects configuration
        type: string
      localDbConfig:
        description: Name of ConfigMap containing LocalDb (PostgreSQL) runtime objects configuration
        type: string
    type: object
type: object
